<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>


  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="generator" content="pandoc">
  <title>Computer Graphics (CS4300) 2011S: Assignment 6</title>
  <link rel="stylesheet" href="HW6_files/style.css" type="text/css">
  <link rel="icon" type="image/png" href="http://www.ccs.neu.edu/course/cs4300/icon.png">
</head><body>
<h1 class="title">Computer Graphics (CS4300) 2011S: Assignment 6</h1>
<p><strong>DUE: 12:01am, Mon Apr 18</strong></p><p><strong>Worth: 15% of your final grade</strong></p><h2 id="goals">Goals</h2><ul><li>understand ray tracing</li><li>implement Lambertian diffuse and Blinn-Phong specular shading</li><li>render shadows</li><li>use perspective projection</li></ul><h2 id="assignment">Assignment</h2><p>For
 this homework you will implement a ray tracer along the lines of that 
described in Chapter 4 of the course text (Shirley and Marschner, 3rd 
edition). All input data will come from a text file, but the <a href="#input-file-format">format</a>
 of this file will not be the same as in prior assignments. Also, 
different from prior assignments, the resulting program need only 
produce a single static image of the scene—interactive viewpoint 
navigation is extra credit.</p><p>For this assignment you <strong>must</strong>
 read the input file from the standard input stream. If your program is 
written in java, then you must be able to run it from the command line 
like this:</p><p><code>java HW6_Sample &lt; input.rts</code></p><p>This 
way it is much faster and less laborious (less typing both for you and 
for us) to run your program on different inputs because it allows</p><ul><li>command line history—typing the up-arrow key in most modern shells recalls prior command lines without a lot of typing</li><li>filename completion—typing the start of a filename or path followed by the tab key suggests a completion, again saving typing</li><li>multiple input files concatenated into a single scene:<br> <code>cat input0.rts input1.rts input2.rts | java HW6_Sample</code></li><li>automatic invocation of your program from a shell script.</li></ul><p>Note that one consequence of reading from standard input is that it is not always possible to <em>rewind</em> the input stream, as you would need if you were going to make multiple passes over it. <strong>It is not necessary to make multiple passes over the input.</strong> There may be forward references in the input. This is not a problem. Just parse every line as you see it and <em>store the references</em>. Then, do all dereferencing after reading the entire input.</p><h2 id="input-file-format">Input File Format</h2><p>The
 input file for this assignment is an ASCII text file. By convention, 
the file name extension is “.rts” which stands for “ray tracing scene.” 
However, your program should not care about the filename.</p><p>Each line has a syntax determined by its first two characters. (The meaning, or <em>semantics</em>, of each line type is described in detail below.)</p><p><strong>Line types marked with an * are extra credit features.</strong></p><table><thead><tr class="header"><th align="right">line type</th><th align="left"></th><th align="right">start</th><th align="left"></th><th align="left">rest</th></tr></thead><tbody><tr class="odd"><td align="right"><em>comment</em></td><td align="left"></td><td align="right"><tt>##</tt></td><td align="left"></td><td align="left">any text</td></tr><tr class="even"><td align="right"><em>vertex</em></td><td align="left"></td><td align="right"><tt>vv</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn000.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> <img src="HW6_files/eqn001.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="11"> <img src="HW6_files/eqn002.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="10"> <img src="HW6_files/eqn003.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="17"> <img src="HW6_files/eqn004.png" style="vertical-align: -6px; margin: 0pt;" height="20" width="17"> <img src="HW6_files/eqn005.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="17"></td></tr><tr class="odd"><td align="right"><em>ambient material</em></td><td align="left"></td><td align="right"><tt>am</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn006.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="10"> <img src="HW6_files/eqn007.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="10"> <img src="HW6_files/eqn008.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="9"></td></tr><tr class="even"><td align="right"><em>diffuse material</em></td><td align="left"></td><td align="right"><tt>dm</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn006.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="10"> <img src="HW6_files/eqn007.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="10"> <img src="HW6_files/eqn008.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="9"></td></tr><tr class="odd"><td align="right"><em>specular material</em></td><td align="left"></td><td align="right"><tt>sm</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn006.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="10"> <img src="HW6_files/eqn007.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="10"> <img src="HW6_files/eqn008.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="9"> <img src="HW6_files/eqn009.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="11"></td></tr><tr class="even"><td align="right"><em>triangle</em></td><td align="left">*</td><td align="right"><tt>ts</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"> <img src="HW6_files/eqn011.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="9"> <img src="HW6_files/eqn012.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"></td></tr><tr class="odd"><td align="right"><em>sphere</em></td><td align="left"></td><td align="right"><tt>ss</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"></td></tr><tr class="even"><td align="right"><em>plane</em></td><td align="left"></td><td align="right"><tt>ps</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"></td></tr><tr class="odd"><td align="right"><em>settings</em></td><td align="left"></td><td align="right"><tt>se</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn013.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"> <img src="HW6_files/eqn014.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="9"> <img src="HW6_files/eqn015.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> <img src="HW6_files/eqn016.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="16"> <img src="HW6_files/eqn017.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"></td></tr><tr class="even"><td align="right"><em>point light</em></td><td align="left"></td><td align="right"><tt>pl</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"> <img src="HW6_files/eqn017.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"></td></tr><tr class="odd"><td align="right"><em>directional light</em></td><td align="left"></td><td align="right"><tt>dl</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"> <img src="HW6_files/eqn017.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"></td></tr><tr class="even"><td align="right"><em>camera</em></td><td align="left"></td><td align="right"><tt>cc</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"></td></tr><tr class="odd"><td align="right"><em>translation</em></td><td align="left">*</td><td align="right"><tt>tx</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn000.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> <img src="HW6_files/eqn001.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="11"> <img src="HW6_files/eqn002.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="10"></td></tr><tr class="even"><td align="right"><em>rotation</em></td><td align="left">*</td><td align="right"><tt>rx</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn018.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="16"> <img src="HW6_files/eqn019.png" style="vertical-align: -6px; margin: 0pt;" height="16" width="16"> <img src="HW6_files/eqn020.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="15"></td></tr><tr class="odd"><td align="right"><em>homogneous xform</em></td><td align="left">*</td><td align="right"><tt>hx</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn021.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="79"> <img src="HW6_files/eqn022.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="79"> <img src="HW6_files/eqn023.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="79"></td></tr><tr class="even"><td align="right"><em>undo transform</em></td><td align="left">*</td><td align="right"><tt>ux</tt></td><td align="left"></td><td align="left"></td></tr><tr class="odd"><td align="right"><em>clear transform</em></td><td align="left">*</td><td align="right"><tt>ix</tt></td><td align="left"></td><td align="left"></td></tr><tr class="even"><td align="right"><em>start model</em></td><td align="left">*</td><td align="right"><tt>so</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn024.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="41"></td></tr><tr class="odd"><td align="right"><em>end model</em></td><td align="left">*</td><td align="right"><tt>eo</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn025.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="12"></td></tr><tr class="even"><td align="right"><em>instance model</em></td><td align="left">*</td><td align="right"><tt>io</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn024.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="41"></td></tr><tr class="odd"><td align="right"><em>rebase indexing</em></td><td align="left">*</td><td align="right"><tt>rv</tt></td><td align="left"></td><td align="left"><img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"></td></tr></tbody></table><p>Each type of line may appear any number of times in the input. They may come in any order, but the <em>relative</em> order does matter for some types of lines, as detailed below.</p><p>All values on a line are whitespace separated (one or more spaces or tabs).</p><p><strong>Your program must tolerate lines that do not start with any of the above prefixes, or any that you do not implement.</strong>
 You may emit a warning message, but you should effectively ignore any 
such line. This can allow your program to process input files that 
include extra-credit extensions (but ignore those extensions).</p><p>The values <img src="HW6_files/eqn026.png" style="vertical-align: -6px; margin: 0pt;" height="20" width="175">
 stand for any floating point number in the following format: (a) an 
optional leading + or - symbol; (b) between 1 and 4 decimal digits; (c) 
an optional fractional part consisting of a decimal point and between 1 
and 4 decimal digits.</p><p>The values <img src="HW6_files/eqn027.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="55"> are also floating point numbers in the same format, but they are restricted to the range <img src="HW6_files/eqn028.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="59"> (your program should clamp input values for these values outside that range).</p><p>The values <img src="HW6_files/eqn029.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="60"> are non-negative integers.</p><p>The values <img src="HW6_files/eqn009.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="11"> is an integer in the range <img src="HW6_files/eqn030.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="50">.</p><p>The values <img src="HW6_files/eqn031.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="58"> are either that literal ASCII character, or the <tt>x</tt> character. For example, <img src="HW6_files/eqn013.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"> could be either <tt>d</tt> or <tt>x</tt>.</p><p>The value <img src="HW6_files/eqn024.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="41">
 is a word starting with any of the characters A-Z, a-z, or _, and 
continuing with any number of the same characters plus the characters 
0–9 and -.</p><h3 id="vertices">Vertices</h3><p>Each line starting in <tt>vv</tt> defines a 3D vertex in world frame. The first three numbers are the vertex location <img src="HW6_files/eqn032.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="54">, and the last three numbers are a direction vector at that location <img src="HW6_files/eqn033.png" style="vertical-align: -6px; margin: 0pt;" height="21" width="75">, which has different meanings in different situations, as described below.</p><p>Your program must create a <em>vertex array</em> corresponding to all the vertices specified in the input, in order. If there are <img src="HW6_files/eqn034.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="12"> vertices in the input, this array will have <img src="HW6_files/eqn034.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="12"> entries, indexed from <img src="HW6_files/eqn035.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="10"> to <img src="HW6_files/eqn036.png" style="vertical-align: -2px; margin: 0pt;" height="16" width="39">. In a language like Java, an easy way to implement this is to store each vertex as you read it from the input into a <code>List</code> <code>l</code> (typically <code>ArrayList</code> is used in a situation like this, but <code>LinkedList</code> will work also). Then after the entire input has been processed, convert the list to an array by calling <code>l.toArray()</code>.</p><h3 id="materials">Materials</h3><p>Lines starting <tt>am</tt>, <tt>dm</tt>, and <tt>sm</tt> change the settings for the ambient, diffuse, and specular parts of the current material properties.</p><p>Before starting to read the input, you must initialize all material properties as follows:</p><ul><li>ambient color: <img src="HW6_files/eqn037.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="162"></li><li>diffuse color: <img src="HW6_files/eqn038.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="162"></li><li>specular color: <img src="HW6_files/eqn038.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="162"></li><li>specular exponent: <img src="HW6_files/eqn039.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="49"></li></ul><p>Then upon reading one of the <tt>*m</tt> material lines from the input, simply update the corresponding values.</p><h3 id="surfaces">Surfaces</h3><p>Lines starting <tt>ts</tt>, <tt>ss</tt>, and <tt>ps</tt>
 define triangle, sphere, and plane surfaces. In each case, the surface 
is defined by specifying one or more indices into the vertex array 
(note, these indices can be in the range <img src="HW6_files/eqn040.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="63"> where <img src="HW6_files/eqn034.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="12"> is the <em>total</em> number of vertices in the input, not just the number of vertices read so far at the time the surface is introduced).</p><ul><li>For a sphere, one vertex is specified. The center of the sphere is given by the <img src="HW6_files/eqn032.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="54"> coordinates of the vertex, and the radius of the sphere is given by <img src="HW6_files/eqn041.png" style="vertical-align: -6px; margin: 0pt;" height="21" width="78">.</li><li>For a plane, one vertex is specified. <img src="HW6_files/eqn032.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="54"> is a point on the plane, and <img src="HW6_files/eqn033.png" style="vertical-align: -6px; margin: 0pt;" height="21" width="75"> is an outward pointing surface normal.</li><li><strong>Triangles are extra credit.</strong> For a triangle, three vertices are specified. The location of each vertex is given by its <img src="HW6_files/eqn032.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="54"> coordinates, and an outward pointing surface normal <img src="HW6_files/eqn042.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="13"> at each vertex is given by <img src="HW6_files/eqn033.png" style="vertical-align: -6px; margin: 0pt;" height="21" width="75">. Note that <img src="HW6_files/eqn042.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="13"> is not necessarily a unit vector as specified in the input; you will likely want to normalize it.</li></ul><p>Your
 program must create some type of datastructure to store all the 
surfaces specified in the input (again, a simple list is reasonable). 
Each surface must also store the material properties that were in effect
 at the time the surface was read from the input.</p><h3 id="transformations-extra-credit">Transformations (Extra Credit)</h3><p>These line types enable you to move and distort surfaces.</p><p><strong>You can skip this section unless you plan to implement this extra credit feature.</strong></p><p>Lines starting <tt>tx</tt>, <tt>rx</tt>, and <tt>hx</tt> multiply a new transform onto the current composite model transform (CMT).</p><p>Before starting to read the input, initialize the CMT to the identity transform.</p><ul><li>upon encountering a <tt>tx</tt> line, pre-multiply a translation transform <img src="HW6_files/eqn043.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="22">, i.e. <img src="HW6_files/eqn044.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="162"></li><li>upon encountering a <tt>rx</tt> line, pre-multiply a rotation transform <img src="HW6_files/eqn045.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="23">. Calculate <img src="HW6_files/eqn045.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="23"> by composing three Euler angle transforms as described in <a href="http://www.ccs.neu.edu/course/cs4300/L15/L15.html">L15</a>: <img src="HW6_files/eqn046.png" style="vertical-align: -6px; margin: 0pt;" height="20" width="103">.</li><li>upon encountering a <tt>hx</tt> line, pre-multiply a general homogneous transform <img src="HW6_files/eqn047.png" style="vertical-align: -36px; margin: 0pt;" height="82" width="221">.</li></ul><p>The <tt>ix</tt> line sets the CMT back to the identity matrix.</p><p>The <tt>ux</tt> line should <em>undo</em> the transform <img src="HW6_files/eqn048.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="19"> from the most recent <tt>tx</tt>, <tt>rx</tt>, or <tt>hx</tt> line since the start of the input or the most recent <tt>ix</tt> line, if any. I.e. <img src="HW6_files/eqn049.png" style="vertical-align: -3px; margin: 0pt;" height="20" width="174">. (If there was no previously multiplied transform, the <tt>ux</tt> line does nothing.)</p><p>Each
 time you parse a surface, store a copy of the current CMT at the time 
of reading that surface, just as you store a copy of the current 
material properties. Then treat all vertices of that surface to be 
transformed by that CMT when you render them.</p><h3 id="instancing-extra-credit">Instancing (Extra Credit)</h3><p>These line types enable you to very flexibly place multiple copies of models at arbitrary locations in your scene.</p><p><strong>You can skip this section unless you plan to implement this extra credit feature.</strong></p><p>A line starting <tt>so</tt> begins the definition of a model with the given name. All surfaces encountered until the subsequent <tt>eo</tt> (end model) line are considered part of that model. It is an error to have an <tt>so</tt> line without a matching <tt>eo</tt> line. Further, it is an error to have any <tt>so</tt> line after another <tt>so</tt> but before the matching <tt>eo</tt>.</p><p>If the <tt>eo</tt> line has its <img src="HW6_files/eqn025.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="12"> flag set, then the model is <em>hidden</em>,
 and no copy of it is added to the scene until it is instantiated. 
Otherwise, an initial copy of each surface in the model is added to the 
scene just as for surfaces that are not part of a model definition.</p><p>A line starting <tt>io</tt>
 instantates the named model, i.e., adds a copy of all the surfacs 
included in the model to the scene. It is an error to instantiate a 
model that is never defined, but it is <em>not</em> an error to instantate a model before it is defined.</p><p>You can handle <tt>io</tt>
 similar, but not exactly, the same as if all the surfaces in the model 
were copied to that point in the file. The only difference is that if <img src="HW6_files/eqn050.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="47"> is the CMT that was in effect at the time the surface was first defined, and <img src="HW6_files/eqn051.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="46"> is the CMT that is in effect at the time the model is instanced, you must use their compound <img src="HW6_files/eqn052.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="92"> as the actual CMT for that instance of that surface.</p><p>Finally, to make mixing different models into the same input file more convenient, the <tt>rv</tt> line adds flexibility to the vertex indexing scheme. If <img src="HW6_files/eqn010.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="7"> is the index given on the <tt>rv</tt> line, and the next vertex index at the time of reading that line was <img src="HW6_files/eqn011.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="9">, then all subsequent vertex indices (both the index implied when reading a <tt>vv</tt> line and the explicit vertex reference indices in surface and other line types) must be adjusted by <img src="HW6_files/eqn053.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="35"> before storing.</p><h3 id="settings">Settings</h3><p>A line starting <tt>se</tt>
 defines some parameters to turn on or off different aspects of the 
rendering. Again, only the last such line should take effect.</p><p>Recall that the contents of this line have the format <img src="HW6_files/eqn013.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"> <img src="HW6_files/eqn014.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="9"> <img src="HW6_files/eqn015.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> <img src="HW6_files/eqn016.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="16"> <img src="HW6_files/eqn017.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11">, with the first three being either the indicated ASCII character or <tt>x</tt>, and the last two a non-negative integer and a value in the range <img src="HW6_files/eqn028.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="59">.</p><p>The <img src="HW6_files/eqn054.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="41">
 values are flags that turn on or off diffuse (Lambertian) shading, 
specular (Blinn-Phong) shading, and shadows (text section 4.7), 
respectively. Each feature is turned on by specifying the corresponding 
character, and off by specifying <tt>x</tt>.</p><p>The integer <img src="HW6_files/eqn016.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="16"> gives the maximum recursion depth for mirror reflection (text section 4.8). Setting <img src="HW6_files/eqn055.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="46"> effectively turns off mirror reflection. <strong>Mirror reflection is extra credit.</strong></p><p>The value <img src="HW6_files/eqn017.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"> gives the ambient light intensity. <img src="HW6_files/eqn056.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="53"> turns off ambient light, and <img src="HW6_files/eqn057.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="53"> gives maximum ambient light.</p><p>Before starting to read the input, set all features to “on” with <img src="HW6_files/eqn058.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="45"> and <img src="HW6_files/eqn057.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="53">.</p><h3 id="lights">Lights</h3><p>Lines starting <tt>pl</tt> and <tt>dl</tt>
 introduce point and directional lights into the scene. In each case the
 light parameters are again specified as an index into the vertex array.
 The value <img src="HW6_files/eqn059.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="97"> is the intensity of the light.</p><ul><li>For a point light, the location of the light is <img src="HW6_files/eqn032.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="54">; the <img src="HW6_files/eqn060.png" style="vertical-align: -6px; margin: 0pt;" height="20" width="62"> components of the vertex are ignored.</li><li>For a directional light, the direction is <img src="HW6_files/eqn033.png" style="vertical-align: -6px; margin: 0pt;" height="21" width="75"> (again, you may want to normalize this vector), and the <img src="HW6_files/eqn061.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="43"> components of the vertex are ignored.</li></ul><p>Besides any point and directional lights specified in the input file, there is also always ambient light.</p><p>All lights are white, i.e.&nbsp;the light color is always <img src="HW6_files/eqn062.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="125">.</p><p>You will likely want a separate datastructure to store all lights specified in the input. Another list is a reasonable choice.</p><h3 id="camera">Camera</h3><p>A line starting <tt>cc</tt> defines the camera pose. There is only one camera, so if there are multiple <tt>cc</tt>
 lines, only the last will take effect. The camera is specified by 
giving its location and viewing direction, again as an index into the 
vertex array.</p><p>For this assignment, you will implement perspective projection. The eye point <img src="HW6_files/eqn063.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> is given by the <img src="HW6_files/eqn032.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="54"> coordinates of the indicated vertex. The view direction (the <img src="HW6_files/eqn064.png" style="vertical-align: -3px; margin: 0pt;" height="16" width="36"> axis of camera frame) is along the vertex direction <img src="HW6_files/eqn065.png" style="vertical-align: -6px; margin: 0pt;" height="21" width="107">, i.e. <img src="HW6_files/eqn066.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="61">. The <img src="HW6_files/eqn067.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="17"> axis of camera frame is along the direction given by the cross product <img src="HW6_files/eqn068.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="84"> (your program should signal an error and ignore the input line if <img src="HW6_files/eqn069.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="65">). Once you have computed <img src="HW6_files/eqn070.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="16"> and <img src="HW6_files/eqn067.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="17">, normalize them to get <img src="HW6_files/eqn071.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="16"> and <img src="HW6_files/eqn072.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="17">. Finally, compute <img src="HW6_files/eqn073.png" style="vertical-align: -5px; margin: 0pt;" height="19" width="89">. You now have an orthogonal basis for the camera frame, expressed as three orthonormal vectors in world frame coordinates.</p><p>Before starting to read the input, initialize <img src="HW6_files/eqn074.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="83">
 and set the camera frame axes to the standard basis. This places the 
default camera at the origin of world frame looking down the negative <img src="HW6_files/eqn002.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="10"> world axis, with the world frame <img src="HW6_files/eqn001.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="11"> axis up. Upon reading each <tt>cc</tt> line in the input, update all the camera parameters. The effect will be that if there are zero <tt>cc</tt>
 lines in the input, the camera will remain at its default location, but
 otherwise it will move to the pose given in the last valid <tt>cc</tt> line.</p><p>Further details of the perspective camera model are given below.</p><h2 id="action-required-features-and-recommended-order-of-implementation">Action! (Required Features and Recommended Order of Implementation)</h2><p>It is <em>strongly recommended</em> that you follow this order. It will be much easier for the course staff to help you with your program that way.</p><ol style="list-style-type: decimal;"><li>Implement a parser for the input file. At this stage you may ignore all lines except <tt>vv</tt>, <tt>ss</tt>, and <tt>cc</tt>. Just get your program to start drawing unshaded spheres.<ol style="list-style-type: lower-alpha;"><li>Open a canvas of <img src="HW6_files/eqn075.png" style="vertical-align: -3px; margin: 0pt;" height="13" width="18"> horizontal pixels and <img src="HW6_files/eqn076.png" style="vertical-align: -6px; margin: 0pt;" height="16" width="18"> vertical pixels, where both are at least 512.</li><li>Set the background color to black <img src="HW6_files/eqn077.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="124">.</li><li>Assume
 diffuse and specular shading, shadows, and mirror reflection are turned
 off. The spheres should thus show up as circles in the default ambient 
color (a gray), due to ambient light.</li><li>Assume a 60 degree (<img src="HW6_files/eqn078.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="28">
 radians) horizontal field of view, a symmetric view frustum, and square
 pixels. This means that a reasonable transformation from a pixel at 
integer coordinates <img src="HW6_files/eqn079.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="39"> (with canvas origin in the upper left, <img src="HW6_files/eqn000.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> right and <img src="HW6_files/eqn001.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="11"> down, as usual) to an image plane point <img src="HW6_files/eqn080.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="12"> in camera frame is <img src="HW6_files/eqn081.png" style="vertical-align: -16px; margin: 0pt;" height="45" width="248">.</li><li>Transform <img src="HW6_files/eqn080.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="12"> to world frame, giving <img src="HW6_files/eqn082.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="16">. The ray through pixel <img src="HW6_files/eqn079.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="39"> thus starts at the eye point <img src="HW6_files/eqn063.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> and has direction <img src="HW6_files/eqn083.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="45">, both in world frame coordinates.</li><li>Implement ray/sphere intersection from text section 4.4.1 and the nearest-hit algorithm from section 4.4.4.</li><li>For each pixel on the canvas, find the nearest hit, if any, in the interval <img src="HW6_files/eqn084.png" style="vertical-align: -3px; margin: 0pt;" height="17" width="45"> to <img src="HW6_files/eqn085.png" style="vertical-align: -3px; margin: 0pt;" height="16" width="52"> along the corresponding ray. Color the pixel accordingly.</li></ol></li><li>Implement
 ambient material colors. Now each sphere should have the ambient color 
that was in effect at the time the sphere was read from the input.</li><li>Implement point and directional lights, diffuse material colors, Lambertian shading (text section 4.5.1), and the <img src="HW6_files/eqn013.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"> flag. Note that the outward pointing normal vector at a point <img src="HW6_files/eqn086.png" style="vertical-align: -5px; margin: 0pt;" height="14" width="12"> on the surface of a sphere with center <img src="HW6_files/eqn087.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="10"> is given by <img src="HW6_files/eqn088.png" style="vertical-align: -5px; margin: 0pt;" height="17" width="41">. You should now have chalky spheres that look 3D.</li><li>Implement specular material colors, Blinn-Phong shading (text section 4.5.2), and the <img src="HW6_files/eqn014.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="9"> flag. You should now have shiny spheres.</li><li>Implement planes (input line type <tt>ps</tt>).</li><li>Implement shadows (text section 4.7) and the <img src="HW6_files/eqn015.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="11"> flag. You should now have shiny spheres that cast shadows on each other and on planes.</li><li><strong>Extra credit.</strong> Implement triangles (input line type <tt>ts</tt>).
 Use the ray/triangle intersection algorithm from text section 4.4.2. 
Use the barycentric coordinates of the intersection point to interpolate
 the outward pointing surface normal at that point from the specified 
surface normals at the triangle vertices. You should now be able to 
render arbitrary triangle mesh surfaces.</li><li><strong>Extra credit.</strong> Implement mirror reflection, text section 4.8, and the <img src="HW6_files/eqn016.png" style="vertical-align: -1px; margin: 0pt;" height="10" width="16"> setting.</li></ol><h2 id="sample-input-files">Sample Input Files</h2><h3 id="mixed-sample">Mixed Sample</h3><p>This <a href="http://www.ccs.neu.edu/course/cs4300/HW6/rts/sample.rts">sample</a> shows the format of the input file and illustrates that vertices may be reference before they are defined.</p><pre><code>## sample input file
se d s x 2 0.3
cc 4
pl 5 0.8
dl 6 0.5
vv 0 0 -10 -1 -1 3
am 1 0 0
vv 10 0 -10 1 -1 3
dm 1 0 0
vv 0 0 -100 0 50 0
sm 1 1 1 16
ts 0 1 3
am 0 1 0
dm 0 1 0
ss 2
vv 10 10 -10 1 1 3
vv 0 0 10 0 0 -1
vv 100 100 0 0 0 0
vv 0 0 0 0 0 -1
</code></pre>The render of this scene at 512 x 512 takes about 1s on a current laptop using the solution code:<br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/sample.png"><img src="HW6_files/sample.png" width="50%"></a></center>
<p>In this rendering, diffuse and specular shading are turned on, 
shadows are turned off, and the maximum recursion for mirror reflection 
computations is 2.</p><p>There are <img src="HW6_files/eqn089.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="11"> vertices with indices <img src="HW6_files/eqn035.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="10"> through <img src="HW6_files/eqn090.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="10">.</p><p>The camera is defined by the vertex at index 4, so the eye point is at <img src="HW6_files/eqn091.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="61"> in world frame and the view direction is <img src="HW6_files/eqn092.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="66">.</p><p>In addition to ambient light with intensity 0.3, there is a point light at <img src="HW6_files/eqn093.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="86"> with intensity 0.8 and a directional light with direction <img src="HW6_files/eqn092.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="66"> and intensity 0.5.</p><p>There is one red curved triangle with vertices <img src="HW6_files/eqn094.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="74">, <img src="HW6_files/eqn095.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="82">, and <img src="HW6_files/eqn096.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="90">.</p><p>There is one green sphere with center <img src="HW6_files/eqn097.png" style="vertical-align: -5px; margin: 0pt;" height="20" width="82"> and radius <img src="HW6_files/eqn098.png" style="vertical-align: -1px; margin: 0pt;" height="14" width="18">.</p><h3 id="one-sphere">One Sphere</h3><p>For debugging your program, it is good to start with a <a href="http://www.ccs.neu.edu/course/cs4300/HW6/rts/1s.rts">very simple scene</a>.
 This scene includes a single green sphere, a point light, and a white 
“ground” plane. By editing the settings line in the file you can turn 
on/off mirror reflections, shadows, specular, and diffuse lighting. You 
can also comment out the <tt>ss</tt> and <tt>ps</tt> lines to enable or 
disable the sphere or plane surfaces, respectively. Here is what you 
should expect your program to render in various cases (all of these 
images are 512x512 and took about 1–2s each to render using the solution
 code, but during debugging you might want to use a much smaller canvas 
size to reduce rendering time):</p><ul><li>everything turned on, max mirror reflection recursion depth 1 (default) <br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/1s.png"><img src="HW6_files/1s.png" width="45%"></a></center></li><li>mirror reflection disabled <br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/1s-d-s-a-0.png"><img src="HW6_files/1s-d-s-a-0.png" width="45%"></a></center></li><li>mirror reflection and shadows disabled <br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/1s-d-s-x-0.png"><img src="HW6_files/1s-d-s-x-0.png" width="45%"></a></center></li><li>mirror reflection, shadows, and specular shading disabled <br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/1s-d-x-x-0.png"><img src="HW6_files/1s-d-x-x-0.png" width="45%"></a></center></li><li>mirror reflection, shadows, specular, and diffuse shading disabled <br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/1s-x-x-x-0.png"><img src="HW6_files/1s-x-x-x-0.png" width="45%"></a></center></li><li>mirror reflection, shadows, specular, and diffuse shading disabled; no plane <br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/1s-x-x-x-0-no-plane.png"><img src="HW6_files/1s-x-x-x-0-no-plane.png" width="45%"></a></center>
</li></ul><h3 id="three-spheres">Three Spheres</h3><a href="http://www.ccs.neu.edu/course/cs4300/HW6/rts/3s-with-checks.rts">Here</a>
 is an input file that replicates the three-sphere scene we looked at in
 class (42 seconds to render at 512x512 with the solution code on a 
current laptop), and <a href="http://www.ccs.neu.edu/course/cs4300/HW6/rts/3s.rts">here</a> it is without the checkerboard (3s to render):<br><center><a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/3s-with-checks.png"><img src="HW6_files/3s-with-checks.png" width="45%"></a> <a href="http://www.ccs.neu.edu/course/cs4300/HW6/img/3s.png"><img src="HW6_files/3s.png" width="45%"></a></center>
<h2 id="turn-in">Turn In</h2><p>Follow the instructions on the <a href="http://www.ccs.neu.edu/course/cs4300/assignments.html#turning-in-assignments">assignments page</a>.</p><h2 id="grading">Grading</h2><p>For this assignment you will be graded based on both the visual output and the code corresponding to the following features:</p><ul><li>spheres with ambient, diffuse, and specular shading: 60 points</li><li>shadows: 20 points</li><li>planes: 10 points</li><li>triangles with ambient, diffuse, and specular shading: +5 extra credit points</li><li>mirror reflection: +5 extra credit points</li><li>full implementation of transformation and instancing: +8 extra credit points</li></ul><p>An
 additional 10 points will be reserved for general aspects of your code,
 including correctness, documentation, organization, and efficiency.</p>
<p id="footer" align="center">this page subject to change &nbsp;|&nbsp; last updated Thu Mar 31 12:38:59 EDT 2011 &nbsp;|&nbsp; <a href="http://www.ccs.neu.edu/course/cs4300/index.html">course homepage</a></p>
</body></html>